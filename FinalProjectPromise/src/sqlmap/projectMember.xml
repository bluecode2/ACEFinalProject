<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL MAP 2.0//EN"
"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="projectMember">
	<select id="getAllProjMember" resultClass="project_member.ProjectMemberBean">
		SELECT * from (
			SELECT us.*, ROWNUM rnum from(
		    	SELECT 
		    	MEMBER_ID AS memberId,
		    	PROJECT_ROLE_ID AS projectRoleId,
		    	EMPLOYEE_ID AS employeeId,
		    	PROJECT_ID AS projectId,
		    	PROJECT_CODE AS projCode,
		    	PROJECT_NAME AS projName,
		    	EMPLOYEE_NAME AS empName,
		    	PROJECT_ROLE_NAME AS projRoleName,
		    	PROJECT_ROLE_CODE AS projRoleCode,
		    	IS_DELETED AS isDeleted
		    	FROM VPROJECTMEMBER
				where IS_DELETED = 0
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="projectCode">
				LOWER(PROJECT_CODE) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="projectName">
				LOWER(PROJECT_NAME) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>
      	 		order by MEMBER_ID) us 
	       WHERE ROWNUM &lt; = #end#)
        WHERE rnum &gt; #begin#
	</select>
	
	<select id="countProjectMember" resultClass="java.lang.Integer"
		parameterClass="java.util.Map">
		SELECT COUNT(1) FROM vprojectMember
		WHERE 1 = 1
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="projectCode">
				LOWER(PROJECT_CODE) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="projectName">
				LOWER(PROJECT_NAME)
				LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>
	</select>
</sqlMap>