<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL MAP 2.0//EN"
"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="generalHoliday">
	<select id="getGeneralHoliday" resultClass="holiday.GeneralHolidayBean" parameterClass="java.util.Map">
		select * from(
		select hol.* , ROWNUM rnum from(
		SELECT 
		GEN_HOLIDAY_ID 		as genHolidayId,
		GEN_HOLIDAY_NAME 	as genHolidayName,
		GEN_HOLIDAY_DATE 	as genHolidayDateInString,
		IS_GENERATED 		as isGenerated,
		created_by 			as createdBy,
		updated_by 			as updatedBy,
		create_date			as createDate, 
		update_date 		as updateDate
		FROM GENERAL_HOLIDAY
		where 1=1
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="genHolidayName">
				LOWER(gen_holiday_name) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>		
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="genHolidayDateInString">
				LOWER(GEN_HOLIDAY_DATE) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>	
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="isGenerated">
				LOWER(is_generated) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>			
		ORDER BY GEN_HOLIDAY_ID ) hol
		where ROWNUM &lt;= #end#)
		where rnum &gt;
		#begin#
	</select>
	
	<select id="getGeneralHolidayByHolId" parameterClass="java.lang.Integer" resultClass="holiday.GeneralHolidayBean">
	SELECT 
		GEN_HOLIDAY_ID 		as genHolidayId,
		GEN_HOLIDAY_NAME 	as genHolidayName,
		GEN_HOLIDAY_DATE 	as genHolidayDateInString,
		IS_GENERATED 		as isGenerated,
		created_by 			as createdBy,
		updated_by 			as updatedBy,
		create_date			as createDate, 
		update_date 		as updateDate
		FROM GENERAL_HOLIDAY
		where gen_holiday_id = #holId#
	</select>
	
	<select id="getNewHolId" resultClass="java.lang.Integer" >
	select max(Gen_holiday_id)+1 from general_holiday
	</select>

	<insert id="insertGeneralHoliday" parameterClass="holiday.GeneralHolidayBean">
		insert into
		GENERAL_HOLIDAY(GEN_HOLIDAY_ID, GEN_HOLIDAY_NAME, GEN_HOLIDAY_DATE, 
		IS_GENERATED, created_by, updated_by, create_date, update_date)
		values (#genHolidayId#, #genHolidayName#,
		#genHolidayDate#, #isGenerated#, #createdBy#, NULL, SYSDATE, NULL)
	</insert>

	<select id="getGeneralHolidayEdit" resultClass="holiday.GeneralHolidayBean">
		SELECT
		GEN_HOLIDAY_ID as genHolidayId,
		GEN_HOLIDAY_NAME as genHolidayName,
		GEN_HOLIDAY_DATE as genHolidayDateInString,
		IS_GENERATED as isGenerated
		FROM GENERAL_HOLIDAY
		where GEN_HOLIDAY_ID = #value#
		ORDER BY
		GEN_HOLIDAY_ID
	</select>

	<update id="editGeneralHoliday" parameterClass="holiday.GeneralHolidayBean">
		UPDATE
		GENERAL_HOLIDAY
		SET
		GEN_HOLIDAY_NAME=#genHolidayName#,
		GEN_HOLIDAY_DATE=#genHolidayDateInString#,
		IS_GENERATED=#isGenerated#
		WHERE GEN_HOLIDAY_ID=#genHolidayId#
	</update>

	<delete id="deleteGeneralHoliday" parameterClass="java.lang.Integer">
		UPDATE
		GENERAL_HOLIDAY
		SET
		IS_GENERATED=0
		WHERE GEN_HOLIDAY_ID=#genHolidayId#
	</delete>

	<select id="countGeneralHoliday" resultClass="java.lang.Integer"
		parameterClass="java.util.Map">
		SELECT COUNT(1) FROM GENERAL_HOLIDAY
				where 1=1
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="genHolidayId">
				LOWER(gen_holiday_id) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="genHolidayName">
				LOWER(gen_holiday_name) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>		
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="genHolidayDateInString">
				LOWER(GEN_HOLIDAY_DATE) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>	
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="isGenerated">
				LOWER(is_generated) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>			

	</select>
</sqlMap>