<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL MAP 2.0//EN"
"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="genCode">

	<select id="selectGeneralCode" resultClass="general.GeneralCodeBean"
		parameterClass="java.util.Map">
		SELECT *
		FROM (SELECT genCode.*, ROWNUM rnum
		FROM (
		SELECT 
		gen_code_id 			AS genCodeId,
		Gen_code_caption 		AS genCodeCaption,
		Parent_Id 				AS parentId,
		IS_ACTIVE				AS isActive,
		GEN_CODE_INDEX 			AS genCodeIndex,
		update_by				as updateBy,
		update_date				as updateDate
		FROM 					general_code
		where IS_ACTIVE = 1
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="genCodeCaption">
				LOWER(gen_code_caption) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="parentId">
				LOWER(Parent_id) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="isActive">
				LOWER(is_active) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>
		order by gen_code_index) genCode
		WHERE ROWNUM &lt;= #end#)
		WHERE rnum
		&gt; #begin#
	</select>

	<select id="countGeneralCode" resultClass="java.lang.Integer" parameterClass="java.util.Map">
		select count(1) from general_code
		where 1=1
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="genCodeId">
				LOWER(gen_code_id) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="genCodeCaption">
				LOWER(gen_code_caption) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="parentId">
				LOWER(Parent_id) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>
		<dynamic prepend="AND">
			<isEqual property="searchField" compareValue="isActive">
				LOWER(is_active) LIKE LOWER( '%' || #searchValue# || '%' )
			</isEqual>
		</dynamic>
	</select>
	
	<select id="getGenCodeWithId" parameterClass="java.lang.String" resultClass="general.GeneralCodeBean">
	SELECT 
		gen_code_id 			AS genCodeId,
		Gen_code_caption 		AS genCodeCaption,
		Parent_Id 				AS parentId,
		IS_ACTIVE				AS isActive,
		GEN_CODE_INDEX 			AS genCodeIndex
		FROM general_code
		where gen_code_id = #tmpGenId# and IS_ACTIVE = 1
	</select>

	<insert id="insertGeneralCode" parameterClass="java.util.Map">
		insert into
		general_code (GEN_CODE_ID, PARENT_ID, GEN_CODE_CAPTION,IS_ACTIVE,
		GEN_CODE_INDEX,update_by, update_date) 
		values (#genCodeId#, #parentId#, #genCodeCaption#, #isActive#,
		#genCodeIndex#,#empId#, SYSDATE)
	</insert>
	<update id="updateGeneralCode" parameterClass="java.util.Map">
		update		general_code set
		Parent_id 			=	#parentId#,
		GEN_CODE_CAPTION 	=	#genCodeCaption#,
		GEN_CODE_INDEX 		=	#genCodeIndex#,
		update_by			= 	#empId#,
		update_date			= 	SYSDATE
		where gen_code_id 	=	#genCodeId#
	</update>

	<delete id="deleteGeneralCode" parameterClass="java.util.Map">
		UPDATE GENERAL_CODE SET
		IS_ACTIVE			=	0
		where gen_code_id	=	#genCodeId#
	</delete>

</sqlMap>